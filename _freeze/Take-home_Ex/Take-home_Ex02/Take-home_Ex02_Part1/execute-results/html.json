{
  "hash": "377232bfcca2b857f855b5aa40ebf276",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 2: Application of Spatial and Spatio-temporal Analysis Methods to Discover the Distribution of Dengue Fever in Tainan City, Taiwan - Geospatial Data Wrangling\"\nformat: \n  html: \n    code-fold: true\n    code-summary: \"Show the code\"\n    code-overflow: wrap\n    code-line-numbers: true\n    code-copy: hover\nexecute: \n  eval: true\n  echo: true\n  freeze: auto\n---\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tidyverse, tmap, sfdep, lubridate)\n```\n:::\n\n\n# Import Data\n\nThe following datasets are used in this exercise.\n\n-   `TAIWAN_VILLAGE_2020`, a geospatial data of village boundary of Taiwan. It is in ESRI shapefile format. The data is in Taiwan Geographic Coordinate System TWD97.\n\n-   `Dengue_Daily.csv`, an aspatial data of reported dengue cases in Taiwan since 1998.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntainan <- st_read(dsn = \"../../data/geospatial\",\n                  layer = \"TAINAN_VILLAGE\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `TAINAN_VILLAGE' from data source \n  `/Users/tangtang/Desktop/IS415 Geospatial Analytics and Applications/practice/is415gaa/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 649 features and 10 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 120.0269 ymin: 22.88751 xmax: 120.6563 ymax: 23.41374\nGeodetic CRS:  TWD97\n```\n\n\n:::\n\n```{.r .cell-code}\ndengue <- read_csv(\"../../data/aspatial/Dengue_Daily.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 106861 Columns: 26\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (23): 個案研判日, 性別, 年齡層, 居住縣市, 居住鄉鎮, 居住村里, 最小統計區, 最小統計區中心點X, 最小統計區中心點Y, 一級...\ndbl   (1): 確定病例數\ndate  (2): 發病日, 通報日\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n# Preparing data for analysis\n\n## Study area preparation\n\nAccording to the task objective given, this exercise requested for counties labelled D01, D02, D04, D06, D07, D08, D32 and D39\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntainan <- tainan[tainan$TOWNID %in% c(\"D01\", \"D02\",\"D04\",\"D06\",\"D07\",\"D08\",\"D32\",\"D39\"),]\nplot(tainan)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: plotting the first 9 out of 10 attributes; use max.plot = 10 to plot\nall\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex02_Part1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n## Dengue fever layer preparation\n\nThis exercise requires dengue cases in Tainan, Taiwan. The original tibble is filtered by the condition where county name is equals to Tainan, and saved back to the same variable name.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndengue <- dengue %>% \n  mutate(年 = factor(year(通報日)),\n         周 = week(通報日)) %>% \n  filter(居住縣市 == \"台南市\",\n         年 == \"2023\",\n         周 >= 31,\n         周 <= 50) \n  \ndengue\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20,789 × 28\n   發病日     個案研判日 通報日     性別  年齡層 居住縣市 居住鄉鎮 居住村里\n   <date>     <chr>      <date>     <chr> <chr>  <chr>    <chr>    <chr>   \n 1 2023-07-20 2023/08/03 2023-08-03 男    65-69  台南市   永康區   崑山里  \n 2 2023-07-20 2023/08/01 2023-08-01 男    5-9    台南市   永康區   復華里  \n 3 2023-07-22 2023/08/04 2023-08-04 女    10-14  台南市   永康區   復華里  \n 4 2023-07-22 2023/07/30 2023-07-30 男    50-54  台南市   永康區   正強里  \n 5 2023-07-24 2023/07/31 2023-07-31 男    10-14  台南市   東區     大智里  \n 6 2023-07-24 2023/07/31 2023-07-31 女    50-54  台南市   北區     None    \n 7 2023-07-24 2023/07/31 2023-07-30 男    65-69  台南市   北區     永祥里  \n 8 2023-07-25 2023/07/30 2023-07-30 女    55-59  台南市   永康區   三合里  \n 9 2023-07-25 2023/08/01 2023-07-30 女    65-69  台南市   南區     大成里  \n10 2023-07-25 2023/08/01 2023-07-30 男    40-44  台南市   北區     大港里  \n# ℹ 20,779 more rows\n# ℹ 20 more variables: 最小統計區 <chr>, 最小統計區中心點X <chr>,\n#   最小統計區中心點Y <chr>, 一級統計區 <chr>, 二級統計區 <chr>,\n#   感染縣市 <chr>, 感染鄉鎮 <chr>, 感染村里 <chr>, 是否境外移入 <chr>,\n#   感染國家 <chr>, 確定病例數 <dbl>, 居住村里代碼 <chr>, 感染村里代碼 <chr>,\n#   血清型 <chr>, 內政部居住縣市代碼 <chr>, 內政部居住鄉鎮代碼 <chr>,\n#   內政部感染縣市代碼 <chr>, 內政部感染鄉鎮代碼 <chr>, 年 <fct>, 周 <dbl>\n```\n\n\n:::\n:::\n\n\nConvert `dengue` to `sf` object such that the object would be able to be projected to `TWD97`. Before conversion, check that there is no missing value in coordinates\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(dengue$最小統計區中心點X == \"None\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(dengue$最小統計區中心點Y == \"None\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10\n```\n\n\n:::\n:::\n\n\nDrop those with None values: Currently could not find a effective way to fill in, so to not obstruct the conversion into a `sf` object, I decided to drop the rows with \"None\" values for the coordinates columns.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndengue <- dengue %>% \n  filter(最小統計區中心點X != \"None\",\n         最小統計區中心點Y != \"None\")\nsum(dengue$最小統計區中心點X == \"None\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(dengue$最小統計區中心點Y == \"None\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\nConvert `dengue` to `sf` object and assign projected coordinate system\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndengue <- st_as_sf(dengue,\n                   coords = c(\"最小統計區中心點X\",\"最小統計區中心點Y\"),\n                   crs = 3824)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nDue to limited memory space, please go to [Part 2](Take-home_Ex/Take-home_Ex02/Take-home_Ex02_Part2.html) for further details.\n",
    "supporting": [
      "Take-home_Ex02_Part1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}